---
import type { ScrollSnapContent as Props } from '~/types';
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import Headline from '~/components/ui/Headline.astro';
import { Icon } from 'astro-icon/components';

const {
  title = await Astro.slots.render('title'),
  subtitle = await Astro.slots.render('subtitle'),
  tagline = await Astro.slots.render('tagline'),
  content = await Astro.slots.render('content'),
  items = [],
  id,
  isDark = false,
  classes = {},
  bg = await Astro.slots.render('bg'),
} = Astro.props;
---

<WidgetWrapper id={id} isDark={isDark} containerClass={`max-w-6xl ${classes?.container ?? ''}`} bg={bg}>
  <style>
    .minimalist-section {
      padding: 4rem 1rem;
    }

    .section-header {
      margin-bottom: 4rem;
    }

    .items-list {
      max-width: 1000px;
      margin: 0 auto;
    }

    .item {
      margin-bottom: 5rem;
      position: relative;
      padding-top: 3rem;
    }

    .item:last-child {
      margin-bottom: 0;
    }

    /* Línea separadora sutil arriba de cada item */
    .item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(
        to right,
        transparent,
        rgba(19, 139, 174, 0.2),
        transparent
      );
    }

    /* Items alternados: izquierda y derecha */
    .item:nth-child(odd) .item-header {
      justify-content: flex-start;
    }

    .item:nth-child(even) .item-header {
      justify-content: flex-end;
    }

    .item-header {
      display: flex;
      align-items: center;
      margin-bottom: 0.75rem;
    }

    .item-title-wrapper {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .item-icon-wrapper {
      display: flex;
      align-items: center;
      width: 100%;
      margin-bottom: 1rem;
    }

    /* Icono con gradiente animado que oscurece progresivamente */
    .item-icon {
      width: 2rem;
      height: 2rem;
      flex-shrink: 0;
      animation: iconPulse 3s ease-in-out infinite;
    }

    /* Colores progresivamente más oscuros usando COMMIT theme */
    .item:nth-child(1) .item-icon {
      color: #ade4f7; /* commit pale */
      filter: drop-shadow(0 0 8px rgba(173, 228, 247, 0.4));
    }

    .item:nth-child(2) .item-icon {
      color: #26bce9; /* commit lighter */
      filter: drop-shadow(0 0 8px rgba(38, 188, 233, 0.4));
    }

    .item:nth-child(3) .item-icon {
      color: #1ba1c9; /* commit light */
      filter: drop-shadow(0 0 8px rgba(27, 161, 201, 0.4));
    }

    .item:nth-child(4) .item-icon {
      color: #138bae; /* commit default */
      filter: drop-shadow(0 0 8px rgba(19, 139, 174, 0.4));
    }

    .item:nth-child(5) .item-icon {
      color: #1283a5; /* commit dark */
      filter: drop-shadow(0 0 8px rgba(18, 131, 165, 0.4));
    }

    .item:nth-child(6) .item-icon {
      color: #117999; /* commit darker */
      filter: drop-shadow(0 0 8px rgba(17, 121, 153, 0.4));
    }

    @keyframes iconPulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.08);
      }
    }

    /* Línea divisoria con gradiente de color que oscurece */
    .divider-line {
      height: 2px;
      flex-grow: 1;
      position: relative;
      overflow: hidden;
    }

    .divider-line::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 100%;
      background: linear-gradient(to right, transparent, transparent);
      animation: shimmer 3s ease-in-out infinite;
    }

    .item:nth-child(1) .divider-line {
      background: linear-gradient(to right, #ade4f7, transparent);
    }

    .item:nth-child(2) .divider-line {
      background: linear-gradient(to left, #26bce9, transparent);
    }

    .item:nth-child(3) .divider-line {
      background: linear-gradient(to right, #1ba1c9, transparent);
    }

    .item:nth-child(4) .divider-line {
      background: linear-gradient(to left, #138bae, transparent);
    }

    .item:nth-child(5) .divider-line {
      background: linear-gradient(to right, #1283a5, transparent);
    }

    .item:nth-child(6) .divider-line {
      background: linear-gradient(to left, #117999, transparent);
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%);
      }
      50% {
        transform: translateX(100%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    /* Orden invertido para items pares */
    .item:nth-child(odd) .item-icon-wrapper {
      flex-direction: row;
    }

    .item:nth-child(even) .item-icon-wrapper {
      flex-direction: row-reverse;
    }

    .item:nth-child(odd) .item-title-wrapper {
      flex-direction: row;
    }

    .item:nth-child(even) .item-title-wrapper {
      flex-direction: row-reverse;
    }

    .item-content {
      padding: 0 2rem;
    }

    .item:nth-child(even) .item-content {
      text-align: right;
    }

    .item-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin: 0;
      color: var(--aw-color-text-heading);
    }

    /* Títulos con gradiente que oscurece progresivamente usando COMMIT theme */
    .item:nth-child(1) .item-title {
      background: linear-gradient(135deg, #ade4f7, #26bce9);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .item:nth-child(2) .item-title {
      background: linear-gradient(135deg, #26bce9, #1ba1c9);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .item:nth-child(3) .item-title {
      background: linear-gradient(135deg, #1ba1c9, #138bae);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .item:nth-child(4) .item-title {
      background: linear-gradient(135deg, #138bae, #1283a5);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .item:nth-child(5) .item-title {
      background: linear-gradient(135deg, #1283a5, #117999);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .item:nth-child(6) .item-title {
      background: linear-gradient(135deg, #117999, #052832);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .item-description {
      font-size: 1rem;
      color: var(--aw-color-text-muted);
      line-height: 1.8;
      max-width: 700px;
    }

    .item:nth-child(even) .item-description {
      margin-left: auto;
    }

    /* Animación sutil al hacer scroll */
    .item {
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 0.8s ease forwards;
    }

    .item:nth-child(1) { animation-delay: 0.1s; }
    .item:nth-child(2) { animation-delay: 0.2s; }
    .item:nth-child(3) { animation-delay: 0.3s; }
    .item:nth-child(4) { animation-delay: 0.4s; }
    .item:nth-child(5) { animation-delay: 0.5s; }
    .item:nth-child(6) { animation-delay: 0.6s; }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 768px) {
      .item {
        padding-top: 2rem;
        margin-bottom: 3rem;
      }

      .item-content {
        padding: 0 1rem;
      }

      .item:nth-child(even) .item-content {
        text-align: left;
      }

      .item:nth-child(even) .item-description {
        margin-left: 0;
      }

      .item-title {
        font-size: 1.1rem;
      }

      .item-description {
        font-size: 0.95rem;
      }

      .item-icon {
        width: 1.75rem;
        height: 1.75rem;
      }
    }
  </style>

  <div class="minimalist-section">
    <!-- Header con título y subtítulo -->
    <div class="section-header">
      <Headline
        title={title}
        subtitle={subtitle}
        tagline={tagline}
        classes={{
          container: 'text-center max-w-3xl mx-auto',
          title: 'text-4xl md:text-5xl font-bold tracking-tighter mb-4 font-heading',
          subtitle: 'max-w-3xl mx-auto text-xl text-muted dark:text-slate-400',
        }}
      />
      {content && <div class="mt-4 text-center max-w-3xl mx-auto text-lg dark:text-slate-400" set:html={content} />}
    </div>

    <!-- Lista de items con diseño alternado -->
    <div class="items-list">
      {items.map((item) => (
        <div class="item">
          <div class="item-header">
            <div class="item-title-wrapper">
              {item.icon && <Icon name={item.icon} class="item-icon" />}
              {item.title && <h3 class="item-title">{item.title}</h3>}
            </div>
          </div>
          <div class="item-icon-wrapper">
            <div class="divider-line"></div>
          </div>
          <div class="item-content">
            {item.description && (
              <p class="item-description" set:html={item.description} />
            )}
          </div>
        </div>
      ))}
    </div>
  </div>
</WidgetWrapper>

