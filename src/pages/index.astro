---
import Layout from "~/layouts/PageLayout.astro";

// Import all necessary widgets
import Hero from "~/components/widgets/Hero.astro";
import Features from "~/components/widgets/Features.astro";
import Features2 from "~/components/widgets/Features2.astro";
import Contact from "~/components/widgets/Contact.astro";
import Steps from "~/components/widgets/Steps.astro";
import Services from "~/components/widgets/Services.astro";
import ScrollSnapContent from "~/components/widgets/ScrollSnapContent.astro";
import TranslatablePage from "~/components/common/TranslatablePage.astro";
import { getPermalink } from "~/utils/permalinks";
import { t } from "~/i18n";
import type { Language } from "~/i18n/types";

// Import animated icons
import websiteIcon from '~/assets/animated-icons/website.gif';
import digitalProcessIcon from '~/assets/animated-icons/digital-process.gif';
import launchIcon from '~/assets/animated-icons/launch.gif';

// Para sitios estáticos, siempre renderizamos en español
// El cliente se encarga de traducir dinámicamente
const lang: Language = 'es';

const metadata = {
  title: "Desarrollo de Apps Web y Móviles | Grape Agency",
  ignoreTitleTemplate: true,
  description: "Agencia especializada en desarrollo de aplicaciones web y móviles para startups y empresas. Creamos MVPs, webapps y soluciones digitales personalizadas con las últimas tecnologías.",
  keywords: [
    'desarrollo de apps',
    'desarrollo web',
    'desarrollo móvil',
    'mvp',
    'startup',
    'webapp',
    'agencia software',
    'aplicaciones personalizadas',
    'desarrollo react',
    'desarrollo node.js',
  ],
  canonical: "https://grape.agency/",
  openGraph: {
    title: "Grape - Desarrollo de Software para Startups y Empresas",
    description: "Transformamos ideas en aplicaciones web y móviles exitosas. Desarrollo ágil, diseño moderno y tecnología de vanguardia.",
    type: "website",
    url: "https://grape.agency/",
    // TODO: Crear og-image-home.jpg (1200x630) - Ver /public/og-images/README.md
    // images: [
    //   {
    //     url: "https://grape.agency/og-image-home.jpg",
    //     width: 1200,
    //     height: 630,
    //     alt: "Grape - Agencia de Desarrollo de Software"
    //   }
    // ],
  },
  twitter: {
    cardType: "summary_large_image",
    title: "Grape - Desarrollo de Apps Web y Móviles",
    description: "Creamos soluciones digitales personalizadas para startups y empresas. Apps, webapps y MVPs.",
  },
};
---

<Layout metadata={metadata}>
  <!-- Script para traducciones dinámicas -->
  <TranslatablePage />

  <!-- ========================================
       SECCIÓN 1: Hero Principal
       Fuente: homes/startup.astro
       ======================================== -->

  <Hero
    actions={[
      {
        variant: "primary",
        text: t(lang, "nav.know_more"),
        href: "#features",
      },
      { text: t(lang, "nav.contact"), href: "#contact" },
    ]}
    image={{ src: "~/assets/images/hero-image.png", alt: "Grape Hero Image" }}
  >
    <Fragment slot="title">
      <span data-i18n-key="hero.title_part1">{t(lang, "hero.title_part1")}</span><br />
      <span data-i18n-key="hero.title_part2">{t(lang, "hero.title_part2")}</span> <span class="relative inline-block">
        <span class="text-accent dark:text-blue-400" data-i18n-key="hero.title_highlight">{t(lang, "hero.title_highlight")}</span>
        <!-- Subrayado SVG animado (comentado) -->
        <!-- <svg
          class="absolute -bottom-2 left-0 w-full h-3"
          viewBox="0 0 300 12"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          preserveAspectRatio="none"
        >
          <path
            d="M2 6C50 2, 100 10, 150 6C200 2, 250 10, 298 6"
            stroke="currentColor"
            stroke-width="4"
            stroke-linecap="round"
            class="text-primary"
            opacity="0.6"
          />
        </svg> -->
      </span>
    </Fragment>

    <Fragment slot="subtitle">
      <span data-i18n-key="hero.subtitle">{t(lang, "hero.subtitle")}</span>
    </Fragment>
  </Hero>

  <!-- ========================================
       SECCIÓN 2: Servicios (Cards)
       Fuente: Nuevo diseño personalizado
       ======================================== -->

  <Services
    id="servicios"
    columns={3}
    items={[
      {
        title: t(lang, "services_section.items.web.title"),
        description: t(lang, "services_section.items.web.description"),
        iconImage: websiteIcon,
        callToAction: {
          text: t(lang, "services_section.items.web.cta"),
          href: getPermalink("/servicios/marketing-landings"),
          variant: "link",
        },
      },
      {
        title: t(lang, "services_section.items.business.title"),
        description: t(lang, "services_section.items.business.description"),
        iconImage: digitalProcessIcon,
        callToAction: {
          text: t(lang, "services_section.items.business.cta"),
          href: getPermalink("/servicios/sistemas-pymes"),
          variant: "link",
        },
      },
      {
        title: t(lang, "services_section.items.custom.title"),
        description: t(lang, "services_section.items.custom.description"),
        iconImage: launchIcon,
        callToAction: {
          text: t(lang, "services_section.items.custom.cta"),
          href: getPermalink("/servicios/desarrollo-medida"),
          variant: "link",
        },
      },
    ]}
  >
    <Fragment slot="tagline">
      <span data-i18n-key="services_section.tagline">{t(lang, "services_section.tagline")}</span>
    </Fragment>
    <Fragment slot="title">
      <span data-i18n-key="services_section.title">{t(lang, "services_section.title")}</span>
    </Fragment>
    <Fragment slot="subtitle">
      <span data-i18n-key="services_section.subtitle">{t(lang, "services_section.subtitle")}</span>
    </Fragment>
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-bg-light dark:bg-transparent"></div>
    </Fragment>
  </Services>

    <!-- ========================================
       SECCIÓN 3: ¿Qué hacemos en GRAPE?
       Fuente: homes/saas.astro (Features)
       ======================================== -->

  <Features
    id="features"
    columns={2}
    items={[
      {
        title: t(lang, "features.items.boutique.title"),
        description: t(lang, "features.items.boutique.description"),
        icon: "tabler:diamond",
      },
      {
        title: t(lang, "features.items.experience.title"),
        description: t(lang, "features.items.experience.description"),
        icon: "tabler:award",
      },
      {
        title: t(lang, "features.items.processes.title"),
        description: t(lang, "features.items.processes.description"),
        icon: "tabler:rocket",
      },
      {
        title: t(lang, "features.items.tech.title"),
        description: t(lang, "features.items.tech.description"),
        icon: "tabler:cpu",
      },
      {
        title: t(lang, "features.items.attention.title"),
        description: t(lang, "features.items.attention.description"),
        icon: "tabler:users",
      },
      {
        title: t(lang, "features.items.support.title"),
        description: t(lang, "features.items.support.description"),
        icon: "tabler:headset",
      },
    ]}
  >
    <Fragment slot="title">
      <span data-i18n-key="features.title">{t(lang, "features.title")}</span>
    </Fragment>
    <Fragment slot="subtitle">
      <span data-i18n-key="features.subtitle">{t(lang, "features.subtitle")}</span>
    </Fragment>
  </Features>

  <!-- ========================================
       SECCIÓN 4: Diferenciación (Content con Scroll Snap)
       Efecto de scroll snapping con transiciones
       ======================================== -->

  <ScrollSnapContent
    id="diferenciacion"
    items={[
      {
        title: t(lang, "differentiation.items.creativity.title"),
        description: t(lang, "differentiation.items.creativity.description"),
        icon: "tabler:bulb",
      },
      {
        title: t(lang, "differentiation.items.quality.title"),
        description: t(lang, "differentiation.items.quality.description"),
        icon: "tabler:award",
      },
      {
        title: t(lang, "differentiation.items.flexibility.title"),
        description: t(lang, "differentiation.items.flexibility.description"),
        icon: "tabler:adjustments",
      },
      {
        title: t(lang, "differentiation.items.custom.title"),
        description: t(lang, "differentiation.items.custom.description"),
        icon: "tabler:puzzle",
      },
      {
        title: t(lang, "differentiation.items.agile.title"),
        description: t(lang, "differentiation.items.agile.description"),
        icon: "tabler:users-group",
      },
      {
        title: t(lang, "differentiation.items.improvement.title"),
        description: t(lang, "differentiation.items.improvement.description"),
        icon: "tabler:trending-up",
      },
    ]}
    image={{
      src: "https://images.unsplash.com/photo-1522071820081-009f0129c71c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80",
      alt: "Equipo Grape trabajando",
    }}
  >
    <Fragment slot="tagline">
      <span data-i18n-key="differentiation.tagline">{t(lang, "differentiation.tagline")}</span>
    </Fragment>
    <Fragment slot="title">
      <span data-i18n-key="differentiation.title">{t(lang, "differentiation.title")}</span>
    </Fragment>
  </ScrollSnapContent>

  <!-- ========================================
       SECCIÓN 5: About Us (Sobre Nosotros)
       Fuente: homes/startup.astro (Features2)
       ======================================== -->

  <Features2>
    <Fragment slot="title">
      <span data-i18n-key="about.title">{t(lang, "about.title")}</span>
    </Fragment>
    <Fragment slot="subtitle">
      <span data-i18n-key="about.subtitle">{t(lang, "about.subtitle")}</span>
    </Fragment>
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-bg-light dark:bg-transparent"></div>
    </Fragment>
  </Features2>

  <!-- ========================================
       SECCIÓN 6: Cómo Trabajamos (Steps)
       Fuente: pages/index.astro (Steps)
       ======================================== -->

  <Steps
    items={[
      {
        title: 'Paso 1: <span class="font-medium" data-i18n-key="steps.items.discovery.title">' + t(lang, "steps.items.discovery.title") + '</span>',
        description: t(lang, "steps.items.discovery.description"),
        icon: "tabler:search",
      },
      {
        title: 'Paso 2: <span class="font-medium" data-i18n-key="steps.items.design.title">' + t(lang, "steps.items.design.title") + '</span>',
        description: t(lang, "steps.items.design.description"),
        icon: "tabler:layout-2",
      },
      {
        title: 'Paso 3: <span class="font-medium" data-i18n-key="steps.items.development.title">' + t(lang, "steps.items.development.title") + '</span>',
        description: t(lang, "steps.items.development.description"),
        icon: "tabler:code",
      },
      {
        title: 'Paso 4: <span class="font-medium" data-i18n-key="steps.items.testing.title">' + t(lang, "steps.items.testing.title") + '</span>',
        description: t(lang, "steps.items.testing.description"),
        icon: "tabler:bug",
      },
      {
        title: 'Paso 5: <span class="font-medium" data-i18n-key="steps.items.launch.title">' + t(lang, "steps.items.launch.title") + '</span>',
        description: t(lang, "steps.items.launch.description"),
        icon: "tabler:rocket",
      },
      {
        title: t(lang, "steps.items.ready"),
        icon: "tabler:check",
      },
    ]}
    image={{
      src: "https://images.unsplash.com/photo-1553877522-43269d4ea984?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80",
      alt: "Proceso de trabajo en Grape",
    }}
  >
    <Fragment slot="title">
      <span data-i18n-key="steps.title">{t(lang, "steps.title")}</span>
    </Fragment>
  </Steps>

  <!-- ========================================
       SECCIÓN 7: Contact Form
       Fuente: pages/contact.astro (Contact)
       ======================================== -->

  <Contact
    id="contact"
    inputs={[
      {
        type: "text",
        name: "name",
        label: t(lang, "contact.name_label"),
      },
      {
        type: "email",
        name: "email",
        label: t(lang, "contact.email_label"),
      },
    ]}
    textarea={{
      label: t(lang, "contact.message_label"),
    }}
    disclaimer={{
      label: t(lang, "contact.disclaimer"),
    }}
  >
    <Fragment slot="title">
      <span data-i18n-key="contact.title">{t(lang, "contact.title")}</span>
    </Fragment>
    <Fragment slot="subtitle">
      <span data-i18n-key="contact.subtitle">{t(lang, "contact.subtitle")}</span>
    </Fragment>
    <Fragment slot="description">
      <span data-i18n-key="contact.description">{t(lang, "contact.description")}</span>
    </Fragment>
  </Contact>

  <!-- ========================================
       SECCIÓN 8: Contact Support Info
       Fuente: pages/contact.astro (Features2)
       ======================================== -->

  <Features2
    items={[
      {
        title: t(lang, "contact_info.items.consulting.title"),
        description: t(lang, "contact_info.items.consulting.description"),
      },
      {
        title: t(lang, "contact_info.items.quotes.title"),
        description: t(lang, "contact_info.items.quotes.description"),
      },
      {
        title: t(lang, "contact_info.items.support.title"),
        description: t(lang, "contact_info.items.support.description"),
      },
      {
        title: t(lang, "contact_info.items.whatsapp.title"),
        description: t(lang, "contact_info.items.whatsapp.value"),
        icon: "tabler:brand-whatsapp",
      },
      {
        title: t(lang, "contact_info.items.email.title"),
        description: t(lang, "contact_info.items.email.value"),
        icon: "tabler:mail",
      },
      {
        title: t(lang, "contact_info.items.location.title"),
        description: t(lang, "contact_info.items.location.value"),
        icon: "tabler:map-pin",
      },
    ]}
  >
    <Fragment slot="title">
      <span data-i18n-key="contact_info.title">{t(lang, "contact_info.title")}</span>
    </Fragment>
  </Features2>
</Layout>
